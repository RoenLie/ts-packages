function m(){return{extensions:[{name:"spanTable",level:"block",start(i){var l;return(l=i.match(/^\n *([^\n ].*\|.*)\n/))==null?void 0:l.index},tokenizer(i,l){const t=new RegExp("^ *([^\\n ].*\\|.*\\n(?: *[^\\s].*\\n)*?) {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n| {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)| {0,3}#{1,6} | {0,3}>| {4}[^\\n]| {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n| {0,3}(?:[*+-]|1[.)]) |<\\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?: +|\\n|\\/?>)|<(?:script|pre|style|textarea|!--)).*(?:\\n|$))*)\\n*|$)").exec(i);if(t){const e={type:"spanTable",header:t[1].replace(/\n$/,"").split(`
`),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split(`
`):[]};e.header[0]=g(e.header[0]);const a=e.header[0].reduce((n,r)=>n+r.colspan,0);if(a===e.align.length){e.raw=t[0];let n,r,s,p,h=e.align.length;for(n=0;n<h;n++)/^ *-+: *$/.test(e.align[n])?e.align[n]="right":/^ *:-+: *$/.test(e.align[n])?e.align[n]="center":/^ *:-+ *$/.test(e.align[n])?e.align[n]="left":e.align[n]=null;for(h=e.header.length,n=1;n<h;n++)e.header[n]=g(e.header[n],a,e.header[n-1]);for(h=e.rows.length,n=0;n<h;n++)e.rows[n]=g(e.rows[n],a,e.rows[n-1]);for(h=e.header.length,r=0;r<h;r++)for(p=e.header[r],s=0;s<p.length;s++)p[s].tokens=[],this.lexer.inline(p[s].text,p[s].tokens);for(h=e.rows.length,r=0;r<h;r++)for(p=e.rows[r],s=0;s<p.length;s++)p[s].tokens=[],this.lexer.inline(p[s].text,p[s].tokens);return e}}},renderer(i){let l,o,t,e,a,n,r="<table>";for(r+="<thead>",l=0;l<i.header.length;l++){t=i.header[l];let s=0;for(r+="<tr>",o=0;o<t.length;o++)e=t[o],n=this.parser.parseInline(e.tokens),r+=d(n,e,"th",i.align[s]),s+=e.colspan;r+="</tr>"}if(r+="</thead>",i.rows.length){for(r+="<tbody>",l=0;l<i.rows.length;l++){for(t=i.rows[l],a=0,r+="<tr>",o=0;o<t.length;o++)e=t[o],n=this.parser.parseInline(e.tokens),r+=d(n,e,"td",i.align[a]),a+=e.colspan;r+="</tr>"}r+="</tbody>"}return r+="</table>",r}}]}}const d=(i,l,o,t)=>l.rowspan?`${`<${o}${l.colspan>1?` colspan=${l.colspan}`:""}${l.rowspan>1?` rowspan=${l.rowspan}`:""}${t?` align=${t}`:""}>`+i}</${o}>
`:"",g=(i,l,o=[])=>{var h,c;const t=[...i.matchAll(/(?:[^|\\]|\\.?)+(?:\|+|$)/g)].map(f=>f[0]);(h=t[0])!=null&&h.trim()||t.shift(),(c=t[t.length-1])!=null&&c.trim()||t.pop();let e=0,a,n,r,s,p;for(a=0;a<t.length;a++){if(r=t[a].split(/\|+$/)[0],t[a]={rowspan:1,colspan:Math.max(t[a].length-r.length,1),text:r.trim().replace(/\\\|/g,"|")},r.slice(-1)==="^"&&o.length)for(p=0,n=0;n<o.length;n++){if(s=o[n],p===e&&s.colspan===t[a].colspan){t[a].rowSpanTarget=s.rowSpanTarget??s,t[a].rowSpanTarget.text+=` ${t[a].text.slice(0,-1)}`,t[a].rowSpanTarget.rowspan+=1,t[a].rowspan=0;break}if(p+=s.colspan,p>e)break}e+=t[a].colspan}if(e>l)t.splice(l);else for(;e<l;)t.push({colspan:1,text:""}),e+=1;return t};export{m as default};
